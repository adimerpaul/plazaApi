import{_ as S,Q as r,R as c,S as o,T as l,V as s,aD as b,U as j,aC as I,L as y,ar as w,X as C,Z as x,b8 as B,aB as Y,W as E,aF as M,aE as q,a3 as k}from"./index.e5bf0941.js";import{a as D,b as f,e as V}from"./QChip.628190ad.js";import{Q as U}from"./QList.fba40d4f.js";import{Q as A}from"./QBtnDropdown.fdcbe686.js";import{b as Q,Q as G,C as O}from"./ClosePopup.0ed816ee.js";import{Q as P,a as z}from"./QSpace.7be629cb.js";import{a as N,Q as T}from"./QForm.4feb36c2.js";import{h as _}from"./moment.40bc58bf.js";import"./QMarkupTable.63640087.js";import"./use-fullscreen.9674130a.js";import"./format.2cae61da.js";const L={name:"CompaniesIndex",data(){return{fechaInicio:_().startOf("month").format("YYYY-MM-DD"),fechaFin:_().endOf("month").format("YYYY-MM-DD"),columns:[{name:"option",label:"Opciones",align:"left",field:e=>e.option},{name:"id",label:"ID",align:"left",field:e=>e.id},{name:"name",label:"Empresa",align:"left",field:e=>{var i,n;return(n=(i=e==null?void 0:e.boat)==null?void 0:i.company)==null?void 0:n.name}},{name:"boat",label:"Barco",align:"left",field:e=>{var i;return(i=e==null?void 0:e.boat)==null?void 0:i.name}},{name:"fechaInicio",label:"Fecha Inicio",align:"left",field:e=>this.$filters.formatdMY(e.fechaInicio)},{name:"fechaFin",label:"Fecha Fin",align:"left",field:e=>this.$filters.formatdMY(e.fechaFin)},{name:"status",label:"Estado",align:"left",field:e=>e.status}],loading:!1,moment:_,viajes:[],viaje:{},viajeDialog:!1,clienDialogHistory:!1,filter:"",passwordShow:!1,boats:[]}},mounted(){this.viajeGet(),this.boatsGet()},methods:{boatsGet(){this.loading=!0,this.$axios.get("boats").then(e=>{this.boats=e.data}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1})},viajeSave(){this.loading=!0,this.viaje.id?this.$axios.put(`viajes/${this.viaje.id}`,this.viaje).then(e=>{this.viajeDialog=!1;const i=this.viajes.findIndex(n=>n.id===this.viaje.id);this.viajes.splice(i,1,e.data)}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1}):this.$axios.post("viajes",this.viaje).then(e=>{this.viajeDialog=!1,this.viajes.unshift(e.data)}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1})},addProducts(e){this.$router.push("/viajesShow/"+e.id)},viajeDelete(e){this.$alert.confirm("\xBFEst\xE1 seguro de eliminar este viaje?").onOk(()=>{this.loading=!0,this.$axios.delete(`viajes/${e.id}`).then(i=>{const n=this.viajes.findIndex(F=>F.id===i.data.id);console.log(n),n!==-1&&this.viajes.splice(n,1)}).catch(i=>{this.$alert.error(i.response.data.message)}).finally(()=>{this.loading=!1})})},viajeEdit(e){this.viajeDialog=!0,this.viaje={...e}},viajeAdd(){this.viajeDialog=!0,this.viaje={fechaInicio:_().format("YYYY-MM-DD"),fechaFin:_().add(1,"week").format("YYYY-MM-DD"),boat_id:""}},viajeGet(){this.loading=!0,this.$axios.get("viajes",{params:{fechaInicio:this.fechaInicio,fechaFin:this.fechaFin}}).then(e=>{this.viajes=e.data}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1})}}},R={class:"row"},H={class:"col-6 col-md-2 q-pa-xs"},W={class:"col-6 col-md-2 q-pa-xs"},X={class:"col-12 col-md-3 q-pa-xs"},Z={class:"col-12 col-md-5 q-pa-xs text-right"},J={class:"text-h6"},K={class:"row"},$={class:"col-12"},ee={class:"col-12"},ae={class:"col-12"};function le(e,i,n,F,t,u){return r(),c(N,{class:"bg-grey-3 q-pa-xs"},{default:o(()=>[l(I,null,{default:o(()=>[s("div",R,[s("div",H,[l(b,{modelValue:t.fechaInicio,"onUpdate:modelValue":i[0]||(i[0]=a=>t.fechaInicio=a),label:"Fecha Inicio",type:"date",outlined:"",dense:""},null,8,["modelValue"])]),s("div",W,[l(b,{modelValue:t.fechaFin,"onUpdate:modelValue":i[1]||(i[1]=a=>t.fechaFin=a),label:"Fecha Fin",type:"date",outlined:"",dense:""},null,8,["modelValue"])]),s("div",X,[l(b,{modelValue:t.filter,"onUpdate:modelValue":i[2]||(i[2]=a=>t.filter=a),label:"Buscar",outlined:"",dense:""},null,8,["modelValue"])]),s("div",Z,[l(j,{color:"indigo",label:"Buscar",onClick:u.viajeGet,"no-caps":"",icon:"search"},null,8,["onClick"]),l(j,{color:"green",label:"Agregar",onClick:u.viajeAdd,"no-caps":"",icon:"add_circle_outline"},null,8,["onClick"])])])]),_:1}),l(G,{rows:t.viajes,columns:t.columns,"rows-per-page-options":[0],"row-key":"id",dense:"",filter:t.filter,loading:t.loading},{"body-cell-option":o(a=>[l(Q,{"auto-width":""},{default:o(()=>[a.row.status!=="Finalizado"?(r(),c(A,{key:0,label:"Opciones",color:"primary","auto-close":"","no-caps":"",size:"10px"},{default:o(()=>[l(U,null,{default:o(()=>[y((r(),c(D,{clickable:"",onClick:d=>u.viajeEdit(a.row)},{default:o(()=>[l(f,{avatar:""},{default:o(()=>[l(w,{name:"edit"})]),_:1}),l(f,null,{default:o(()=>[C("Editar")]),_:1})]),_:2},1032,["onClick"])),[[k]]),y((r(),c(D,{clickable:"",onClick:d=>u.viajeDelete(a.row)},{default:o(()=>[l(f,{avatar:""},{default:o(()=>[l(w,{name:"delete"})]),_:1}),l(f,null,{default:o(()=>[C("Eliminar")]),_:1})]),_:2},1032,["onClick"])),[[k]]),y((r(),c(D,{clickable:"",onClick:d=>u.addProducts(a.row)},{default:o(()=>[l(f,{avatar:""},{default:o(()=>[l(w,{name:"add_shopping_cart"})]),_:1}),l(f,null,{default:o(()=>[C("Agregar productos")]),_:1})]),_:2},1032,["onClick"])),[[k]])]),_:2},1024)]),_:2},1024)):x("",!0)]),_:2},1024)]),"body-cell-name":o(a=>[l(Q,{props:a},{default:o(()=>{var d,m,h,v,p,g;return[l(V,{label:(h=(m=(d=a.row)==null?void 0:d.boat)==null?void 0:m.company)==null?void 0:h.name,"text-color":"white",style:B({backgroundColor:(g=(p=(v=a.row)==null?void 0:v.boat)==null?void 0:p.company)==null?void 0:g.color}),icon:"business"},null,8,["label","style"])]}),_:2},1032,["props"])]),"body-cell-status":o(a=>[l(Q,{props:a},{default:o(()=>{var d,m,h,v,p,g;return[((d=a.row)==null?void 0:d.status)==="Finalizado"?(r(),c(V,{key:0,label:(m=a.row)==null?void 0:m.status,"text-color":"white",dense:"",color:"green"},null,8,["label"])):x("",!0),((h=a.row)==null?void 0:h.status)==="Pendiente"?(r(),c(V,{key:1,label:(v=a.row)==null?void 0:v.status,"text-color":"white",dense:"",color:"orange"},null,8,["label"])):x("",!0),((p=a.row)==null?void 0:p.status)==="En curso"?(r(),c(V,{key:2,label:(g=a.row)==null?void 0:g.status,"text-color":"white",dense:"",color:"blue"},null,8,["label"])):x("",!0)]}),_:2},1032,["props"])]),_:1},8,["rows","columns","filter","loading"]),l(q,{modelValue:t.viajeDialog,"onUpdate:modelValue":i[7]||(i[7]=a=>t.viajeDialog=a),persistent:""},{default:o(()=>[l(I,{style:{width:"250px","max-width":"90vw"}},{default:o(()=>[l(Y,{class:"row items-center q-pb-none"},{default:o(()=>[s("div",J,E(t.viaje.id?"Editar":"Agregar")+" Viaje",1),l(P),l(j,{flat:"",dense:"",icon:"close",onClick:i[3]||(i[3]=a=>t.viajeDialog=!1)})]),_:1}),l(T,{onSubmit:u.viajeSave},{default:o(()=>[l(Y,null,{default:o(()=>[s("div",K,[s("div",$,[l(b,{modelValue:t.viaje.fechaInicio,"onUpdate:modelValue":i[4]||(i[4]=a=>t.viaje.fechaInicio=a),label:"Fecha Inicio",type:"date",outlined:"",dense:"",rules:[a=>!!a||"Campo requerido"]},null,8,["modelValue","rules"])]),s("div",ee,[l(b,{modelValue:t.viaje.fechaFin,"onUpdate:modelValue":i[5]||(i[5]=a=>t.viaje.fechaFin=a),label:"Fecha Fin",type:"date",outlined:"",dense:"",rules:[a=>!!a||"Campo requerido",a=>t.moment(a).isSameOrAfter(t.viaje.fechaInicio)||"La fecha debe ser mayor o igual a la fecha de inicio"]},null,8,["modelValue","rules"])]),s("div",ae,[l(z,{modelValue:t.viaje.boat_id,"onUpdate:modelValue":i[6]||(i[6]=a=>t.viaje.boat_id=a),options:t.boats,label:"Barco",outlined:"",dense:"",rules:[a=>!!a||"Campo requerido"],"map-options":"","emit-value":"","option-value":"id","option-label":"name"},null,8,["modelValue","options","rules"])])])]),_:1}),l(M,{align:"right"},{default:o(()=>[y(l(j,{flat:"",label:"Cancelar",loading:t.loading},null,8,["loading"]),[[O]]),l(j,{color:"primary",label:"Guardar",type:"submit",loading:t.loading},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}var he=S(L,[["render",le]]);export{he as default};
