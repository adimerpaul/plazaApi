import{Q as u}from"./QTooltip.90e2245a.js";import{_,Q as m,R as p,S as o,T as i,U as a,X as f,aD as d,ar as v,aC as y,aB as h,V as s,W as x,aF as Q,L as w,aE as D}from"./index.e5bf0941.js";import{b,Q as E,C as k}from"./ClosePopup.0ed816ee.js";import{e as C}from"./QChip.628190ad.js";import{Q as T,a as I}from"./QSpace.7be629cb.js";import{a as q,Q as N}from"./QForm.4feb36c2.js";import"./QList.fba40d4f.js";import"./QMarkupTable.63640087.js";import"./use-fullscreen.9674130a.js";import"./format.2cae61da.js";const S={name:"ClientsIndex",data(){return{columns:[{name:"option",label:"Opciones",align:"left",field:e=>e.option},{name:"id",label:"ID",align:"left",field:e=>e.id},{name:"name",label:"Nombre",align:"left",field:e=>e.name},{name:"lastname",label:"Apellido",align:"left",field:e=>e.lastname},{name:"company",label:"Empresa",align:"left",field:e=>e.company},{name:"nit",label:"NIT",align:"left",field:e=>e.nit},{name:"phone",label:"Tel\xE9fono",align:"left",field:e=>e.phone},{name:"tipo",label:"Tipo",align:"left",field:e=>e.tipo}],loading:!1,clients:[],client:{},clientDialog:!1,clienDialogHistory:!1,filter:""}},mounted(){this.getClients()},methods:{clientSave(){this.loading=!0,this.client.id?this.$axios.put(`clients/${this.client.id}`,this.client).then(e=>{this.clientDialog=!1;const n=this.clients.findIndex(r=>r.id===this.client.id);this.clients.splice(n,1,e.data)}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1}):this.$axios.post("clients",this.client).then(e=>{this.clientDialog=!1,this.clients.unshift(e.data)}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1})},clientDelete(e){this.$alert.confirm("\xBFEst\xE1 seguro de eliminar este cliente?").onOk(()=>{this.loading=!0,this.$axios.delete(`clients/${e}`).then(n=>{const r=this.clients.findIndex(g=>g.id===e);this.clients.splice(r,1)}).catch(n=>{this.$alert.error(n.response.data.message)}).finally(()=>{this.loading=!1})})},clientHistory(e){this.clienDialogHistory=!0,this.client={...e}},clientEdit(e){this.clientDialog=!0,this.client={...e}},clientAdd(){this.clientDialog=!0,this.client={name:"",ci:""}},getClients(){this.loading=!0,this.$axios.get("clients").then(e=>{this.clients=e.data}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1})}}},U={class:"text-h6"},A={class:"row"},B={class:"col-12"},P={class:"col-12"},O={class:"col-12"},H={class:"col-12"},L={class:"col-12"},R={class:"col-12"};function F(e,n,r,g,t,c){return m(),p(q,{class:"bg-grey-3 q-pa-md"},{default:o(()=>[i(E,{rows:t.clients,columns:t.columns,title:"Clientes","rows-per-page-options":[0],"row-key":"id",dense:"",filter:t.filter,loading:t.loading},{"body-cell-option":o(l=>[i(b,{"auto-width":""},{default:o(()=>[i(a,{flat:"",dense:"",icon:"edit",onClick:V=>c.clientEdit(l.row)},{default:o(()=>[i(u,null,{default:o(()=>[f("Editar")]),_:1})]),_:2},1032,["onClick"]),i(a,{flat:"",dense:"",icon:"delete",onClick:V=>c.clientDelete(l.row.id)},{default:o(()=>[i(u,null,{default:o(()=>[f("Eliminar")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),"body-cell-tipo":o(l=>[i(b,{"auto-width":""},{default:o(()=>[l.row.tipo==="CLIENTE"?(m(),p(C,{key:0,"text-color":"white",label:"Cliente",color:"green"})):(m(),p(C,{key:1,"text-color":"white",label:"Proveedor",color:"indigo"}))]),_:2},1024)]),"top-right":o(()=>[i(a,{outline:"",dense:"",icon:"add_circle",onClick:c.clientAdd,label:"Agregar","no-caps":"",loading:t.loading},{default:o(()=>[i(u,null,{default:o(()=>[f("Agregar")]),_:1})]),_:1},8,["onClick","loading"]),i(d,{modelValue:t.filter,"onUpdate:modelValue":n[0]||(n[0]=l=>t.filter=l),dense:"",class:"q-ml-md",debounce:"300",placeholder:"Buscar",outlined:""},{append:o(()=>[i(v,{name:"search"})]),_:1},8,["modelValue"])]),_:1},8,["rows","columns","filter","loading"]),i(D,{modelValue:t.clientDialog,"onUpdate:modelValue":n[8]||(n[8]=l=>t.clientDialog=l),persistent:""},{default:o(()=>[i(y,{style:{width:"250px","max-width":"90vw"}},{default:o(()=>[i(h,{class:"row items-center q-pb-none"},{default:o(()=>[s("div",U,x(t.client.id?"Editar":"Agregar")+" Cliente",1),i(T),i(a,{flat:"",dense:"",icon:"close",onClick:n[1]||(n[1]=l=>t.clientDialog=!1)})]),_:1}),i(N,{onSubmit:c.clientSave},{default:o(()=>[i(h,null,{default:o(()=>[s("div",A,[s("div",B,[i(d,{modelValue:t.client.name,"onUpdate:modelValue":n[2]||(n[2]=l=>t.client.name=l),label:"Nombre",outlined:"",dense:"",rules:[l=>!!l||"Campo requerido"]},null,8,["modelValue","rules"])]),s("div",P,[i(d,{modelValue:t.client.lastname,"onUpdate:modelValue":n[3]||(n[3]=l=>t.client.lastname=l),label:"Apellido",outlined:"",dense:"",rules:[l=>!!l||"Campo requerido"]},null,8,["modelValue","rules"])]),s("div",O,[i(d,{modelValue:t.client.company,"onUpdate:modelValue":n[4]||(n[4]=l=>t.client.company=l),label:"Empresa",outlined:"",dense:"",rules:[l=>!!l||"Campo requerido"]},null,8,["modelValue","rules"])]),s("div",H,[i(d,{modelValue:t.client.nit,"onUpdate:modelValue":n[5]||(n[5]=l=>t.client.nit=l),label:"NIT",outlined:"",dense:"",rules:[l=>!!l||"Campo requerido"]},null,8,["modelValue","rules"])]),s("div",L,[i(d,{modelValue:t.client.phone,"onUpdate:modelValue":n[6]||(n[6]=l=>t.client.phone=l),label:"Tel\xE9fono",outlined:"",dense:"",rules:[l=>!!l||"Campo requerido"]},null,8,["modelValue","rules"])]),s("div",R,[i(I,{modelValue:t.client.tipo,"onUpdate:modelValue":n[7]||(n[7]=l=>t.client.tipo=l),label:"Tipo",outlined:"",dense:"",options:[{label:"Cliente",value:"CLIENTE"},{label:"Proveedor",value:"PROVEEDOR"}],rules:[l=>!!l||"Campo requerido"],"emit-value":"","map-options":""},null,8,["modelValue","rules"])])])]),_:1}),i(Q,{align:"right"},{default:o(()=>[w(i(a,{flat:"",label:"Cancelar",loading:t.loading},null,8,["loading"]),[[k]]),i(a,{color:"primary",label:"Guardar",type:"submit",loading:t.loading},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}var $=_(S,[["render",F]]);export{$ as default};
